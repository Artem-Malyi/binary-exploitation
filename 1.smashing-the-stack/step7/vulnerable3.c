//
// vulnerable3.c
//
// Simplest program vulnerable to buffer overflow attack.
// This one is with very small buffer size - only 4 bytes.
//

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

static const int VULNERABLE_BUFFER_SIZE = 4;

void vuln(char* exploitation_string) {
    char buffer[VULNERABLE_BUFFER_SIZE];
    memset(buffer, 'A', sizeof(buffer));
    strcpy(buffer, exploitation_string);
}

void main(int argc, char* argv[]) {
    if (argc <= 1)
        exit(-1);
    printf("Going to copy %d bytes to the buffer of size %d... ", strlen(argv[1]), VULNERABLE_BUFFER_SIZE);
    vuln(argv[1]);
    printf("Done!\n");
    // <--- this is where our program will jump on the altered return address
    exit(0);
}

