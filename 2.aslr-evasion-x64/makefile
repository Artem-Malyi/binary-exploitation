BUILD_DIR=build
FLAGS=-z execstack -fno-stack-protector -no-pie -fno-pic -g -O0

all: execve-bin-sh

help:
	cat readme

prep:
	mkdir -p ${BUILD_DIR}

execve-bin-sh: prep
	as step1/$@.s -o ${BUILD_DIR}/$@.o
	ld ${BUILD_DIR}/$@.o -o ${BUILD_DIR}/$@
	gcc ${FLAGS} step1/shellcode.c -o ${BUILD_DIR}/test-execve-bin-sh
	gcc ${FLAGS} step1/vuln.c -o ${BUILD_DIR}/vuln1

clean:
	rm -rf ${BUILD_DIR}

