//
// example2.s
//
// This is a null-byte-free, position-independent-code version of example1.
// Just for reference of a starting point to implement a shellcode.
//

.text
    .global _start
    _start:
        jmp 1f
    2:
        popl %esi
        xorl %eax, %eax
        movb $0x4, %al  /* write system call number */
        xorl %ebx, %ebx
        inc  %ebx       /* stdout */
        movl %esi, %ecx /* the data to print */
        xorl %edx, %edx
        movb $0xc, %dl  /* length of the buffer */
        int  $0x80

        xorl %ebx, %ebx /* exit status */
        movl %ebx, %eax
        inc  %eax       /* exit system call number */
        int  $0x80
    1:
        call 2b
        .ascii "hello world\n"
